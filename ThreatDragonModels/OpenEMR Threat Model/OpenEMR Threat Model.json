{
  "version": "2.2.0",
  "summary": {
    "title": "OpenEMR Threat Model",
    "owner": "Michael Ashe",
    "description": "OpenEMR is a Free and Open Source electronic health records and medical practice management application. It features fully integrated electronic health records, practice management, scheduling, electronic billing, internationalization, free support, a vibrant community, and a whole lot more. It runs on Windows, Linux, Mac OS X, and many other platforms.\n\nhttps://github.com/openemr/openemr",
    "id": 0
  },
  "detail": {
    "contributors": [],
    "diagrams": [
      {
        "id": 0,
        "title": "OpenEMR Threat Diagram",
        "diagramType": "STRIDE",
        "placeholder": "New STRIDE diagram description",
        "thumbnail": "./public/content/images/thumbnail.stride.jpg",
        "version": "2.2.0",
        "cells": [
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "205cb8e5-b78a-403e-9355-7cc0c82b5f8e",
            "source": {
              "cell": "6654bbbc-0073-4af5-a453-03180756f423"
            },
            "target": {
              "cell": "3038f1cf-bc5a-4f1d-ad14-436d84868ba4"
            },
            "vertices": [
              {
                "x": 840,
                "y": 280
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "ec3e5b89-02c0-4bbf-badd-e76f967fc3f9",
            "source": {
              "cell": "1f3d82e3-8f49-4065-9b31-d9acc95ce5c3"
            },
            "target": {
              "cell": "3038f1cf-bc5a-4f1d-ad14-436d84868ba4"
            },
            "vertices": [
              {
                "x": 570,
                "y": 270
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "3a381612-717e-4a1c-aa18-fd4b84dad615",
            "source": {
              "cell": "3038f1cf-bc5a-4f1d-ad14-436d84868ba4"
            },
            "target": {
              "cell": "1f3d82e3-8f49-4065-9b31-d9acc95ce5c3"
            },
            "vertices": [
              {
                "x": 570,
                "y": 360
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e0928ee0-ae79-4a5f-8d9a-56559cd6daf7",
            "source": {
              "cell": "3038f1cf-bc5a-4f1d-ad14-436d84868ba4"
            },
            "target": {
              "cell": "6654bbbc-0073-4af5-a453-03180756f423"
            },
            "vertices": [
              {
                "x": 820,
                "y": 370
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "d6e936dc-7401-4397-b45e-e13869f16ab8",
            "source": {
              "x": 310,
              "y": 170
            },
            "target": {
              "x": 280,
              "y": 460
            },
            "vertices": [
              {
                "x": 350,
                "y": 320
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "38b48a93-629b-4876-90bb-02155f0cba7c",
            "source": {
              "cell": "3038f1cf-bc5a-4f1d-ad14-436d84868ba4"
            },
            "target": {
              "cell": "48db2bcc-c56e-46ce-9289-b7546d8d0ecc"
            },
            "vertices": [
              {
                "x": 770,
                "y": 210
              }
            ]
          },
          {
            "shape": "trust-boundary-curve",
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Boundary",
              "name": "",
              "description": "",
              "isTrustBoundary": true,
              "hasOpenThreats": false
            },
            "id": "55f84a81-68b9-4f96-95b1-6072fedf4a68",
            "source": {
              "x": 690,
              "y": 180
            },
            "target": {
              "x": 700,
              "y": 460
            },
            "vertices": [
              {
                "x": 750,
                "y": 320
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "e72a592d-9edf-4e86-b00f-099d3390ae9e",
            "source": {
              "cell": "4746eb8b-a11b-44bf-a953-b13c57a99e35"
            },
            "target": {
              "cell": "1f3d82e3-8f49-4065-9b31-d9acc95ce5c3"
            },
            "vertices": [
              {
                "x": 360,
                "y": 315
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "a6f6f513-de5d-459b-8b9b-6e75dbc07022",
            "source": {
              "cell": "2d141ab5-820f-4fe7-8baf-c2429dd72ca3"
            },
            "target": {
              "cell": "1f3d82e3-8f49-4065-9b31-d9acc95ce5c3"
            }
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": ""
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "Data Flow",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": false,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "0263a5bc-18cd-48eb-b874-d81853c067e2",
            "source": {
              "x": 666,
              "y": 355
            },
            "target": {
              "cell": "bbb872e1-465a-4004-ab27-c6ff257baa26"
            },
            "vertices": [
              {
                "x": 750,
                "y": 430
              }
            ]
          },
          {
            "shape": "flow",
            "attrs": {
              "line": {
                "stroke": "#333333",
                "targetMarker": {
                  "name": "block"
                },
                "sourceMarker": {
                  "name": "block"
                },
                "strokeDasharray": null
              }
            },
            "width": 200,
            "height": 100,
            "zIndex": 10,
            "connector": "smooth",
            "data": {
              "type": "tm.Flow",
              "name": "",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isBidirectional": true,
              "isEncrypted": false,
              "isPublicNetwork": false,
              "protocol": "",
              "threats": []
            },
            "id": "39210334-8861-43c9-a3d7-2f6654cafd55",
            "source": {
              "cell": "a7e99c11-da87-4698-a50f-3ad751e68462"
            },
            "target": {
              "cell": "1f3d82e3-8f49-4065-9b31-d9acc95ce5c3"
            },
            "vertices": [
              {
                "x": 330,
                "y": 415
              },
              {
                "x": 370,
                "y": 350
              }
            ],
            "tools": {
              "items": [
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead",
                "boundary",
                "button-remove",
                "vertices",
                "source-arrowhead",
                "target-arrowhead"
              ],
              "name": null
            }
          },
          {
            "position": {
              "x": 150,
              "y": 205
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Admin"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 11,
            "id": "2d141ab5-820f-4fe7-8baf-c2429dd72ca3",
            "data": {
              "type": "tm.Actor",
              "name": "Admin",
              "description": "Highest privilege, can manage users as well as other features",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 626.25,
              "y": 265
            },
            "size": {
              "width": 100,
              "height": 90
            },
            "attrs": {
              "text": {
                "text": "Web Server"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 13,
            "id": "3038f1cf-bc5a-4f1d-ad14-436d84868ba4",
            "data": {
              "type": "tm.Process",
              "name": "Web Server",
              "description": "Handles all web requests and responses, main part of application that provides and receives data from datastore",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "9cf441a8-1249-4945-9d2f-fc3e50c5fb4f",
                  "title": "Port squatting",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Spoofing",
                  "description": "An attacker could squat on the random port or socket that the server normally uses.",
                  "mitigation": "Appropriate authentication",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 5,
                  "score": "2"
                },
                {
                  "id": "0b42ee8e-71fc-4d87-b848-202e88351ac0",
                  "title": "Forcing data through validation paths",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Elevation of privilege",
                  "description": "An attacker can force data through different validation paths which give different results.",
                  "mitigation": "Run with least privilege",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 8,
                  "score": "5"
                },
                {
                  "id": "b7c14faa-6f3c-47c2-8455-7fa48bd56c6b",
                  "title": "Log entries without timestamps",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": " An attacker can create a log entry without a timestamp (or no log entry is timestamped).",
                  "mitigation": "Timestamps on logs",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 9,
                  "score": "6"
                }
              ]
            }
          },
          {
            "position": {
              "x": 936.25,
              "y": 305
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Patient PHI"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 15,
            "id": "6654bbbc-0073-4af5-a453-03180756f423",
            "data": {
              "type": "tm.Store",
              "name": "Patient PHI",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "060cb93b-52aa-4261-92d8-f030d1c11baf",
                  "title": "Altering info in data store with weak ACLs",
                  "status": "Open",
                  "severity": "High",
                  "type": "Tampering",
                  "description": " An attacker can alter information in a data store because it has weak ACLs or includes a group which is equivalent to everyone (“all Live ID holders”).",
                  "mitigation": "Appropriate authorization\nTamper resistant protocols",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 11,
                  "score": "10"
                }
              ]
            }
          },
          {
            "position": {
              "x": 513.75,
              "y": 220
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Web Request"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 16,
            "id": "c1278797-edd6-4e40-884e-3abd9592e346",
            "data": {
              "type": "tm.Text",
              "name": "Web Request",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 510,
              "y": 355
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Web Response"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 17,
            "id": "95083249-4130-4ffd-8808-b0c33cd7abb5",
            "data": {
              "type": "tm.Text",
              "name": "Web Response",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 766.25,
              "y": 365
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Queries"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 18,
            "id": "a474ae2f-5e03-49aa-ac64-59bc9980c839",
            "data": {
              "type": "tm.Text",
              "name": "Queries",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 786.25,
              "y": 220
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Query Results"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 19,
            "id": "4f7318fc-2f69-4f59-ac4b-7df80c149f9b",
            "data": {
              "type": "tm.Text",
              "name": "Query Results",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 120,
              "y": 295
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Patient"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 20,
            "id": "4746eb8b-a11b-44bf-a953-b13c57a99e35",
            "data": {
              "type": "tm.Actor",
              "name": "Patient",
              "description": "Lowest privilege, can view their own health records and schedule calendar/send messages",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 390,
              "y": 260
            },
            "size": {
              "width": 120,
              "height": 100
            },
            "attrs": {
              "text": {
                "text": "Authentication"
              },
              "body": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "process",
            "zIndex": 21,
            "id": "1f3d82e3-8f49-4065-9b31-d9acc95ce5c3",
            "data": {
              "type": "tm.Process",
              "name": "Authentication",
              "description": "Auth server that takes in all user login requests and verifies them, providing access to valid logins.",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "handlesCardPayment": false,
              "handlesGoodsOrServices": false,
              "isWebApplication": false,
              "privilegeLevel": "",
              "threats": [
                {
                  "id": "19b56154-fd70-4784-9f45-5f94f5d994db",
                  "title": "Breached passwords can be easily used",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker who gets a password can reuse it",
                  "mitigation": "Appropriate authentication\nProtect secret data ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 3,
                  "score": "9"
                },
                {
                  "id": "5c21ef7d-fee6-4cba-b4e5-58bbd0cd370f",
                  "title": "Stored credentials",
                  "status": "Open",
                  "severity": "High",
                  "type": "Spoofing",
                  "description": "An attacker could steal credentials stored on the server and reuse them (for example, a key is stored in a world readable file).",
                  "mitigation": "Don’t store secrets\nProtect secret data ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 4,
                  "score": "8"
                },
                {
                  "id": "f958fe19-834f-468b-b0ec-46e03392da96",
                  "title": "Auth system unusable/unavailable",
                  "status": "Open",
                  "severity": "Low",
                  "type": "Denial of service",
                  "description": "An attacker can make your authentication system unusable or unavailable.",
                  "mitigation": "Appropriate authentication\nFiltering\nThrottling\nQuality of service",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 6,
                  "score": "2"
                },
                {
                  "id": "e90a8248-e8de-477a-98e2-424ff205e621",
                  "title": "Hidden or occluded data forgotten",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker can read data because it’s hidden or occluded (for undo or change tracking) and the user might forget that it’s there.",
                  "mitigation": "Encryption\nProtect secrets\nDon’t store secrets",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 7,
                  "score": "6"
                }
              ]
            }
          },
          {
            "position": {
              "x": 251.25,
              "y": 205
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Login"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 22,
            "id": "00c6e667-5ad9-4d26-986f-cfe14e6c8c5d",
            "data": {
              "type": "tm.Text",
              "name": "Login",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 936.25,
              "y": 145
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Messages"
              },
              "topLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "stroke": "red",
                "strokeWidth": 2.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 24,
            "id": "48db2bcc-c56e-46ce-9289-b7546d8d0ecc",
            "data": {
              "type": "tm.Store",
              "name": "Messages",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": true,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": [
                {
                  "id": "77f51f24-086c-4751-94f3-a03c98bbb03e",
                  "title": "Altering messages with weak signature system",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Information disclosure",
                  "description": "An attacker can read content because messages (for example, an email or HTTP cookie) aren't encrypted even if the channel is encrypted.",
                  "mitigation": "Privacy-enhanced protocols\nEncryption\n",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 10,
                  "score": "4"
                },
                {
                  "id": "a9c3c3be-cfad-4ecb-aaa2-dd5d51a2a8ac",
                  "title": "Altering messages with weak signature",
                  "status": "Open",
                  "severity": "Medium",
                  "type": "Repudiation",
                  "description": "An attacker can alter files or messages because the digital signature system you’re implementing is weak, or uses MACs where it should use a signature.",
                  "mitigation": "Digital signatures ",
                  "modelType": "STRIDE",
                  "new": false,
                  "number": 12,
                  "score": "4"
                }
              ]
            }
          },
          {
            "position": {
              "x": 786.25,
              "y": 140
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Send/receive messages"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 25,
            "id": "9d345c76-aab6-4e83-8ddb-f91514b16523",
            "data": {
              "type": "tm.Text",
              "name": "Send/receive messages",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 150,
              "y": 385
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Physician"
              },
              "body": {
                "stroke": "#333333",
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "actor",
            "zIndex": 26,
            "id": "a7e99c11-da87-4698-a50f-3ad751e68462",
            "data": {
              "type": "tm.Actor",
              "name": "Physician",
              "description": "Middle privilege, can do things that patients can't but not what an admin can do",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "providesAuthentication": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 251.25,
              "y": 280
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Login"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 27,
            "id": "dfd2cb14-bca0-48f5-8591-d596666b561a",
            "data": {
              "type": "tm.Text",
              "name": "Login",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 232.5,
              "y": 340
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Login"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 28,
            "id": "22a21b86-64ef-45d9-a8b4-92f7cedcbf62",
            "data": {
              "type": "tm.Text",
              "name": "Login",
              "hasOpenThreats": false
            }
          },
          {
            "position": {
              "x": 926.25,
              "y": 415
            },
            "size": {
              "width": 120,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Calendar"
              },
              "topLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              },
              "bottomLine": {
                "strokeWidth": 1.5,
                "strokeDasharray": null
              }
            },
            "visible": true,
            "shape": "store",
            "zIndex": 29,
            "id": "bbb872e1-465a-4004-ab27-c6ff257baa26",
            "data": {
              "type": "tm.Store",
              "name": "Calendar",
              "description": "",
              "outOfScope": false,
              "reasonOutOfScope": "",
              "hasOpenThreats": false,
              "isALog": false,
              "isEncrypted": false,
              "isSigned": false,
              "storesCredentials": false,
              "storesInventory": false,
              "threats": []
            }
          },
          {
            "position": {
              "x": 766.25,
              "y": 435
            },
            "size": {
              "width": 112.5,
              "height": 60
            },
            "attrs": {
              "text": {
                "text": "Update calendar"
              }
            },
            "visible": true,
            "shape": "td-text-block",
            "zIndex": 30,
            "id": "cdef80e3-0d7a-4399-92e7-b4f203820f31",
            "data": {
              "type": "tm.Text",
              "name": "Update calendar",
              "hasOpenThreats": false
            }
          }
        ],
        "description": "Threat Diagram for OpenEMR"
      }
    ],
    "diagramTop": 1,
    "reviewer": "Jack Liu, Dean BenMoshe",
    "threatTop": 13
  }
}